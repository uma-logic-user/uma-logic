# UMA-Logic PRO 使い方ガイド

**最終更新**: 2026-02-04  
**対象**: 土日の競馬予想を行いたいユーザー

---

## 📋 目次

1. [システム概要](#1-システム概要)
2. [土曜日の使い方](#2-土曜日の使い方)
3. [日曜日の使い方](#3-日曜日の使い方)
4. [Streamlit UIの見方](#4-streamlit-uiの見方)
5. [GitHub Actionsの手動実行方法](#5-github-actionsの手動実行方法)
6. [トラブルシューティング](#6-トラブルシューティング)

---

## 1. システム概要

UMA-Logic PROは、JRAの競馬予想を自動化するシステムです。

### 自動実行スケジュール

| 時刻 (JST) | 処理内容 | 説明 |
|-----------|---------|------|
| **土曜 07:00** | 予想データ取得 | 土曜のレースカード＋AI予想生成 |
| **土曜 18:00** | 結果データ取得 | 土曜のレース結果＋払戻金取得 |
| **日曜 07:00** | 予想データ取得 | 日曜のレースカード＋AI予想生成 |
| **日曜 18:00** | 結果データ取得 | 日曜のレース結果＋払戻金取得 |

### 通知

- **Discord**: 予想生成完了時、結果取得完了時に通知
- 通知には的中率・回収率・推奨馬が含まれます

---

## 2. 土曜日の使い方

### 朝（07:00以降）

1. **Discord通知を確認**
   - 「🐎 予想データ取得完了」の通知が届きます
   - 通知には本日の推奨レースが含まれます

2. **Streamlit UIで詳細を確認**
   - URL: `https://your-streamlit-url.com`（または `streamlit run app_commercial.py`）
   - 「🎯 本日の予想」タブを開く
   - 競馬場を選択し、各レースの予想を確認

3. **予想の見方**
   | 印 | 意味 | 推奨度 |
   |----|------|--------|
   | ◎ | 本命 | 最も勝つ可能性が高い |
   | ○ | 対抗 | 2番目に有力 |
   | ▲ | 単穴 | 穴馬として期待 |
   | △ | 連下 | 連対の可能性あり |
   | × | 消し | 今回は厳しい |

4. **馬券購入**
   - 「💰 資金配分」タブで推奨投資額を確認
   - ケリー基準に基づいた資金配分を参考に購入

### 夕方（18:00以降）

1. **Discord通知を確認**
   - 「📊 レース結果取得完了」の通知が届きます
   - 的中したレースがあれば通知に含まれます

2. **Streamlit UIで結果を確認**
   - 「📊 レース結果」タブで着順・払戻金を確認
   - 「🎉 的中実績」タブで的中履歴を確認

---

## 3. 日曜日の使い方

土曜日と同じ流れです。

### 朝（07:00以降）
- Discord通知 → Streamlit UIで予想確認 → 馬券購入

### 夕方（18:00以降）
- Discord通知 → Streamlit UIで結果確認

---

## 4. Streamlit UIの見方

### タブ構成

| タブ | 内容 |
|-----|------|
| 🎯 本日の予想 | 今日のレース予想（印、UMA指数、期待値） |
| 📊 レース結果 | 過去のレース結果（着順、払戻金） |
| 🎉 的中実績 | 的中したレースの履歴 |
| 📈 収支レポート | 累積収支グラフ |
| 💰 資金配分 | ケリー基準に基づく投資額計算 |
| 🧠 AI学習状況 | AI重み、的中率、回収率、資産推移シミュレーション |
| ⚙️ システム | データ統計、ワークフロー状態 |

### 予想画面の見方

```
🏇 5R 3歳未勝利 (ダート1400m)
┌─────────────────────────────────────────┐
│ [Sランク] ◎ 8 シルバーステート          │
│ UMA指数: 85.2 | 期待値: 1.42 | オッズ: 3.5 │
│ 騎手: ルメール | 種牡馬: ディープインパクト │
└─────────────────────────────────────────┘
```

- **ランク**: S+ > S > A > B > C（Sランク以上が勝負レース）
- **UMA指数**: AIが算出した勝率スコア（100点満点）
- **期待値**: 1.0以上ならプラス期待値（買い推奨）

---

## 5. GitHub Actionsの手動実行方法

自動実行を待たずに、手動でデータを取得できます。

### 手順

1. **GitHubにアクセス**
   - https://github.com/uma-logic-user/uma-logic

2. **Actionsタブを開く**
   - 上部メニューの「Actions」をクリック

3. **ワークフローを選択**
   | ワークフロー名 | 用途 |
   |--------------|------|
   | 🐎 予想データ取得 | 今日の予想を取得 |
   | 📊 レース結果取得 | 今日の結果を取得 |
   | 🧠 2025年シミュレーション | AI学習を実行 |
   | 💹 リアルタイムオッズ | 直前オッズを取得 |

4. **Run workflowをクリック**
   - 右側の「Run workflow」ボタンをクリック
   - 「Run workflow」で実行開始

5. **完了を待つ**
   - 緑のチェックマーク ✅ が表示されたら完了
   - Discord通知も届きます

### スマホからの実行

1. **GitHubアプリ**をインストール（iOS/Android）
2. リポジトリを開く
3. 「Actions」タブ → ワークフロー選択 → 「Run workflow」

---

## 6. トラブルシューティング

### Q: 予想データが表示されない

**原因**: GitHub Actionsが実行されていない可能性

**解決策**:
1. GitHub → Actions → 「🐎 予想データ取得」を手動実行
2. 完了後、Streamlit UIをリロード

### Q: Discord通知が届かない

**原因**: Webhook URLが設定されていない

**解決策**:
1. GitHub → Settings → Secrets and variables → Actions
2. `DISCORD_WEBHOOK` が設定されているか確認
3. Discordサーバーで新しいWebhook URLを取得して設定

### Q: 的中率・回収率が0%と表示される

**原因**: AI学習が実行されていない

**解決策**:
1. GitHub → Actions → 「🧠 2025年シミュレーション」を手動実行
2. 完了後、`weights.json` が更新されます

### Q: レース結果が取得できない

**原因**: レース終了前に実行した可能性

**解決策**:
- 土曜・日曜の18:00以降に「📊 レース結果取得」を実行
- 全レース終了後（通常17:00頃）に実行してください

### Q: 古いデータしか表示されない

**原因**: ブラウザキャッシュまたはStreamlitキャッシュ

**解決策**:
1. Streamlit UIで「🔄 重み再読み込み」ボタンをクリック
2. ブラウザをハードリロード（Ctrl+Shift+R）

---

## 📞 サポート

問題が解決しない場合は、GitHubのIssuesで報告してください。

- **リポジトリ**: https://github.com/uma-logic-user/uma-logic
- **Issues**: https://github.com/uma-logic-user/uma-logic/issues

---

## 📅 週間スケジュール

```
月曜日: 休み（データ蓄積のみ）
火曜日: 休み
水曜日: 休み
木曜日: 休み
金曜日: 21:00 - 土曜の予想準備（自動）
土曜日: 07:00 - 予想取得 / 18:00 - 結果取得
日曜日: 07:00 - 予想取得 / 18:00 - 結果取得
```

---

**Happy Racing! 🐎**
